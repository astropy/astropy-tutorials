
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Using astropy.coordinates to Match Catalogs and Plan Observations &#8212; astropy-tutorials v3.0.dev</title>
    <link rel="stylesheet" href="../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.0.dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Edit a FITS header" href="../FITS-header/FITS-header.html" />
    <link rel="prev" title="Astropy Tutorials" href="../../index.html" />
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="../../_static/copybutton.js"></script>


  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:tutorials</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="../FITS-header/FITS-header.html" title="Edit a FITS header">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../../index.html" title="Astropy Tutorials">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../index.html">astropy-tutorials v3.0.dev</a>
	 &#187;
      </li>
      
      <li>Using <code class="docutils literal"><span class="pre">astropy.coordinates</span></code> to Match Catalogs and Plan Observations</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 0;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="section" id="Using-astropy.coordinates-to-Match-Catalogs-and-Plan-Observations">
<h1>Using <code class="docutils literal"><span class="pre">astropy.coordinates</span></code> to Match Catalogs and Plan Observations<a class="headerlink" href="#Using-astropy.coordinates-to-Match-Catalogs-and-Plan-Observations" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial, we will explore how the <code class="docutils literal"><span class="pre">astropy.coordinates</span></code>
package and related astropy functionality can be used to help in
planning observations or other exercises focused on large coordinate
catalogs.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Python standard-library</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>
<span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlretrieve</span>

<span class="c1"># Third-party dependencies</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Set up matplotlib and use a nicer set of plot parameters</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">astropy_mpl_style</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">astropy_mpl_style</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="section" id="Describing-on-sky-locations-with-coordinates">
<h2>Describing on-sky locations with <code class="docutils literal"><span class="pre">coordinates</span></code><a class="headerlink" href="#Describing-on-sky-locations-with-coordinates" title="Permalink to this headline">¶</a></h2>
<p>Let’s start by considering a field around the picturesque Hickson
Compact Group 7. To do anything with this, we need to get an object that
represents the coordinates of the center of this group.</p>
<p>In Astropy, the most common object you’ll work with for coordinates is
<code class="docutils literal"><span class="pre">SkyCoord</span></code>. A <code class="docutils literal"><span class="pre">SkyCoord</span></code> can be created most easily directly from
angles as shown below. It’s also wise to explicitly specify the frame
your coordinates are in, although this is not strictly necessary because
the default is ICRS.</p>
<p>(If you’re not sure what ICRS is, it’s basically safe to think of it as
an approximation to an equatorial system at the J2000 equinox).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hcg7_center</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">9.81625</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="mf">0.88806</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>
<span class="n">hcg7_center</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[3]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    ( 9.81625,  0.88806)&gt;
</pre></div>
</div>
</div>
<p>SkyCoord will also accept string-formatted coordinates either as
separate strings for ra/dec or a single string. You’ll have to give
units, though, if they aren’t part of the string itself.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;0h39m15.9s&#39;</span><span class="p">,</span> <span class="s1">&#39;0d53m17.016s&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[4]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    ( 9.81625,  0.88806)&gt;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;0:39:15.9 0:53:17.016&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">),</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[5]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    ( 9.81625,  0.88806)&gt;
</pre></div>
</div>
</div>
<p>If the object you’re interested in is in
<a class="reference external" href="http://cdsweb.u-strasbg.fr/cgi-bin/Sesame">SESAME</a>, you can also
look it up directly from its name using the <code class="docutils literal"><span class="pre">SkyCoord.from_name()</span></code>
class method1. Note that this requires an internet connection. It’s safe
to skip if you don’t have one, because we defined it above explicitly.</p>
<blockquote>
<div>1If you don’t know what a class method is, think of it like an</div></blockquote>
<p>alternative constructor for a <code class="docutils literal"><span class="pre">SkyCoord</span></code> object – calling
<code class="docutils literal"><span class="pre">SkyCoord.from_name()</span></code> with a name gives you a new <code class="docutils literal"><span class="pre">SkyCoord</span></code>
object. For more detailed background on what class methods are and when
they’re useful, see <a class="reference external" href="https://julien.danjou.info/blog/2013/guide-python-static-class-abstract-methods">this
page</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hcg7_center</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="s1">&#39;HCG 7&#39;</span><span class="p">)</span>
<span class="n">hcg7_center</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    ( 9.849602,  0.87817)&gt;
</pre></div>
</div>
</div>
<p>This object we just created has various useful ways of accessing the
information contained within it. In particular, the <code class="docutils literal"><span class="pre">ra</span></code> and <code class="docutils literal"><span class="pre">dec</span></code>
attributes are specialized
<code class="docutils literal"><span class="pre">`Quantity</span></code> &lt;<a class="reference external" href="http://docs.astropy.org/en/stable/units/index.html">http://docs.astropy.org/en/stable/units/index.html</a>&gt;`__
objects (actually, a subclass called
<code class="docutils literal"><span class="pre">`Angle</span></code> &lt;<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.coordinates.Angle.html">http://docs.astropy.org/en/stable/api/astropy.coordinates.Angle.html</a>&gt;`__,
which in turn is subclassed by
<code class="docutils literal"><span class="pre">`Latitude</span></code> &lt;<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.coordinates.Latitude.html">http://docs.astropy.org/en/stable/api/astropy.coordinates.Latitude.html</a>&gt;`__
and
<code class="docutils literal"><span class="pre">`Longitude</span></code> &lt;<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.coordinates.Longitude.html">http://docs.astropy.org/en/stable/api/astropy.coordinates.Longitude.html</a>&gt;`__).
These objects store angles and provide pretty representations of those
angles, as well as some useful attributes to quickly convert to common
angle units:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="nb">type</span><span class="p">(</span><span class="n">hcg7_center</span><span class="o">.</span><span class="n">ra</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">hcg7_center</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[7]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>(astropy.coordinates.angles.Longitude, astropy.coordinates.angles.Latitude)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hcg7_center</span><span class="o">.</span><span class="n">dec</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
<p><img src="../../_images/math/ad4155bb75b8639534eb55cea73a8e58e356c77e.png" alt="$0^\circ52{}^\prime41.412{}^{\prime\prime}$"/></p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hcg7_center</span><span class="o">.</span><span class="n">ra</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
<p><img src="../../_images/math/887b930bdc997ba7a9091040aea23d39a833cabf.png" alt="$9^\circ50{}^\prime58.5672{}^{\prime\prime}$"/></p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hcg7_center</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">hour</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[10]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>0.6566401333333335
</pre></div>
</div>
</div>
<p>Now that we have a <code class="docutils literal"><span class="pre">SkyCoord</span></code> object, we can try to use it to access
data from the <a class="reference external" href="http://www.sdss.org/">Sloan Digitial Sky Survey</a>
(SDSS). Let’s start by trying to get a picture using the SDSS image
cutout service to make sure HCG7 is in the SDSS footprint and has good
image quality.</p>
<p>This requires an internet connection, but if it fails, don’t worry: the
file is included in the repository so you can just let it use the local
file<code class="docutils literal"><span class="pre">'HCG7_SDSS_cutout.jpg'</span></code>, defined at the top of the cell.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">impix</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">imsize</span> <span class="o">=</span> <span class="mi">12</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcmin</span>
<span class="n">cutoutbaseurl</span> <span class="o">=</span> <span class="s1">&#39;http://skyservice.pha.jhu.edu/DR12/ImgCutout/getjpeg.aspx&#39;</span>
<span class="n">query_string</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">hcg7_center</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                              <span class="n">dec</span><span class="o">=</span><span class="n">hcg7_center</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                              <span class="n">width</span><span class="o">=</span><span class="n">impix</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">impix</span><span class="p">,</span>
                              <span class="n">scale</span><span class="o">=</span><span class="n">imsize</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">impix</span><span class="p">))</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">cutoutbaseurl</span> <span class="o">+</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="n">query_string</span>

<span class="c1"># this downloads the image to your disk</span>
<span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;HCG7_SDSS_cutout.jpg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[11]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>(&#39;HCG7_SDSS_cutout.jpg&#39;, &lt;http.client.HTTPMessage at 0x10cb86710&gt;)
</pre></div>
</div>
</div>
<p>Now lets take a look at the image.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;HCG7_SDSS_cutout.jpg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_coordinates_coordinates_20_0.jpeg" src="../../_images/tutorials_coordinates_coordinates_20_0.jpeg" />
</div>
</div>
<p>Very pretty!</p>
<div class="section" id="Exercises">
<h3>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h3>
<p>Create a <code class="docutils literal"><span class="pre">SkyCoord</span></code> of some other astronomical object you find
interesting. Using only a single method/function call, get a string with
the RA/Dec in the form ‘HH:MM:SS.S DD:MM:SS.S’. Check your answer
against an academic paper or some web site like
<a class="reference external" href="http://simbad.u-strasbg.fr/simbad/">SIMBAD</a> that will show you
sexigesimal coordinates for the object.</p>
<p>(Hint: <code class="docutils literal"><span class="pre">SkyCoord.to_string()</span></code> might be worth reading up on)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p>Now get an image of that object from the Digitized Sky Survey and
download it and/or show it in the notebook. Bonus points if you figure
out the (one-line) trick to get it to display in the notebook <em>without</em>
ever downloading the file yourself.</p>
<p>(Hint: STScI has an easy-to-access <a class="reference external" href="https://archive.stsci.edu/dss/">copy of the
DSS</a>. The pattern to follow for the
web URL is
<code class="docutils literal"><span class="pre">http://archive.stsci.edu/cgi-bin/dss_search?f=GIF&amp;ra=RA&amp;dec=DEC</span></code>)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Using-coordinates-and-table-to-match-and-compare-catalogs">
<h2>Using <code class="docutils literal"><span class="pre">coordinates</span></code> and <code class="docutils literal"><span class="pre">table</span></code> to match and compare catalogs<a class="headerlink" href="#Using-coordinates-and-table-to-match-and-compare-catalogs" title="Permalink to this headline">¶</a></h2>
<p>At the end of the last section, we determined that HCG7 is in the SDSS
imaging survey, so that means we can use the cells below to download
catalogs of objects directly from the SDSS. Later on, we will match this
catalog to another catalog covering the same field, allowing us to make
plots using the combination of the two catalogs.</p>
<p>We will access the SDSS SQL database using the
<a class="reference external" href="https://astroquery.readthedocs.org">astroquery</a> affiliated package.
This will require an internet connection and a working install of
astroquery. If you don’t have these you can just skip down two cells,
because the data files are provided with the repository. Depending on
your version of astroquery it might also issue a warning, which you
should be able to safely ignore.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">astroquery.sdss</span> <span class="kn">import</span> <span class="n">SDSS</span>
<span class="n">sdss</span> <span class="o">=</span> <span class="n">SDSS</span><span class="o">.</span><span class="n">query_region</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="n">hcg7_center</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcmin</span><span class="p">,</span>
                         <span class="n">spectro</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                         <span class="n">photoobj_fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/Users/adrian/anaconda/envs/tutorials-dev/lib/python3.6/site-packages/astroquery/sdss/__init__.py:29: UserWarning: Experimental: SDSS has not yet been refactored to have its API match the rest of astroquery (but it&#39;s nearly there).
  warnings.warn(&#34;Experimental: SDSS has not yet been refactored to have its API &#34;
</pre></div></div>
</div>
<p><code class="docutils literal"><span class="pre">astroquery</span></code> queries gives us back an <code class="docutils literal"><span class="pre">`astropy.table.Table</span></code>
object &lt;<a class="reference external" href="http://docs.astropy.org/en/stable/table/index.html">http://docs.astropy.org/en/stable/table/index.html</a>&gt;`__. We could
just work with this directly without saving anything to disk if we
wanted to. But here we will use the capability to write to disk. That
way, if you quit the session and come back later, you don’t have to run
the query a second time.</p>
<p>(Note that this won’t work fail if you skipped the last step. Don’t
worry, you can just skip to the next cell with <code class="docutils literal"><span class="pre">Table.read</span></code> and use
the copy of this table included in the tutorial.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sdss</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;HCG7_SDSS_photo.dat&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
WARNING: AstropyDeprecationWarning: HCG7_SDSS_photo.dat already exists. Automatically overwriting ASCII files is deprecated. Use the argument &#39;overwrite=True&#39; in the future. [astropy.io.ascii.ui]
</pre></div></div>
</div>
<p>If you don’t have internet, you can read the table into python by
running the cell below. But if you did the astroquery step above, you
could skip this, as the table is already in memory as the <code class="docutils literal"><span class="pre">sdss</span></code>
variable.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sdss</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;HCG7_SDSS_photo.dat&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Ok, so we have a catalog of objects we got from the SDSS. Now lets say
you have your own catalog of objects in the same field that you want to
match to this SDSS catalog. In this case, we will use a catalog
extracted from the <a class="reference external" href="http://www.ipac.caltech.edu/2mass/">2MASS</a>. We
first load up this catalog into python.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">twomass</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;HCG7_2MASS.tbl&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now to do matching we need <code class="docutils literal"><span class="pre">SkyCoord</span></code> objects. We’ll have to build
these from the tables we loaded, but it turns out that’s pretty
straightforward: we grab the RA and dec columns from the table and
provide them to the <code class="docutils literal"><span class="pre">SkyCoord</span></code> constructor. Lets first have a look at
the tables to see just what everything is that’s in them.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">sdss</span> <span class="c1"># just to see an example of the format</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[17]:
</pre></div>
</div>
<div class="output_area docutils container">
&lt;Table length=682&gt;
<table id="table4519523384" class="table-striped table-bordered table-condensed">
<thead><tr><th>ra</th><th>dec</th><th>u</th><th>g</th><th>r</th><th>i</th><th>z</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>9.77671799922</td><td>0.751356875167</td><td>22.36938</td><td>21.29412</td><td>20.14603</td><td>19.65756</td><td>19.39209</td></tr>
<tr><td>9.77226352003</td><td>1.08772051033</td><td>19.3459</td><td>18.18987</td><td>17.78777</td><td>17.6289</td><td>17.60235</td></tr>
<tr><td>10.065470729</td><td>0.595214029512</td><td>19.12723</td><td>18.21047</td><td>17.97034</td><td>17.88815</td><td>17.8364</td></tr>
<tr><td>10.1384468866</td><td>0.608841745204</td><td>22.90436</td><td>20.51319</td><td>19.07403</td><td>17.64244</td><td>16.87299</td></tr>
<tr><td>9.52318666268</td><td>0.982256987613</td><td>18.36884</td><td>16.84995</td><td>16.30858</td><td>16.13083</td><td>16.01591</td></tr>
<tr><td>9.63699942831</td><td>1.16412271164</td><td>19.60619</td><td>18.62202</td><td>18.25113</td><td>18.1231</td><td>18.08956</td></tr>
<tr><td>10.1307290306</td><td>0.83608106537</td><td>19.53773</td><td>18.28045</td><td>17.67952</td><td>17.31405</td><td>17.09687</td></tr>
<tr><td>9.83155187287</td><td>1.1212527596</td><td>22.2616</td><td>19.92106</td><td>18.55919</td><td>17.5119</td><td>16.92615</td></tr>
<tr><td>9.78788692127</td><td>1.1424036489</td><td>21.88085</td><td>19.62179</td><td>18.1226</td><td>16.40912</td><td>15.48559</td></tr>
<tr><td>9.84476622736</td><td>0.836230720693</td><td>19.29573</td><td>16.73906</td><td>15.34158</td><td>14.73667</td><td>14.3591</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>9.85015240594</td><td>1.00941389131</td><td>22.79017</td><td>19.93356</td><td>18.57176</td><td>17.65981</td><td>17.13897</td></tr>
<tr><td>9.69389626833</td><td>1.11425662554</td><td>26.13163</td><td>20.6128</td><td>20.56435</td><td>20.34916</td><td>19.66869</td></tr>
<tr><td>9.91318165979</td><td>1.10494984959</td><td>20.45888</td><td>19.25467</td><td>18.52454</td><td>18.19474</td><td>17.88742</td></tr>
<tr><td>9.86140974949</td><td>0.745947843825</td><td>23.01928</td><td>21.50809</td><td>20.29095</td><td>19.78649</td><td>19.47331</td></tr>
<tr><td>9.55446133731</td><td>1.14220591661</td><td>23.06536</td><td>23.08205</td><td>22.12111</td><td>21.67837</td><td>21.63256</td></tr>
<tr><td>10.0565426584</td><td>0.591103275467</td><td>20.35315</td><td>18.69015</td><td>18.22211</td><td>18.12444</td><td>17.8771</td></tr>
<tr><td>9.63379865776</td><td>1.04451580716</td><td>20.88008</td><td>19.80103</td><td>18.69122</td><td>18.20208</td><td>17.96495</td></tr>
<tr><td>9.83106890787</td><td>0.625042547249</td><td>22.88215</td><td>22.44291</td><td>20.8858</td><td>19.80261</td><td>19.30529</td></tr>
<tr><td>9.6888150127</td><td>0.7663167309</td><td>22.79572</td><td>20.11252</td><td>18.80546</td><td>18.14293</td><td>17.74013</td></tr>
<tr><td>10.0962896435</td><td>0.75846152856</td><td>20.7785</td><td>20.07056</td><td>19.57321</td><td>19.46497</td><td>19.15103</td></tr>
</table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">twomass</span> <span class="c1"># just to see an example of the format</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[18]:
</pre></div>
</div>
<div class="output_area docutils container">
&lt;Table masked=True length=23&gt;
<table id="table4306413440" class="table-striped table-bordered table-condensed">
<thead><tr><th>designation</th><th>ra</th><th>dec</th><th>r_k20fe</th><th>j_m_k20fe</th><th>j_msig_k20fe</th><th>j_flg_k20fe</th><th>h_m_k20fe</th><th>h_msig_k20fe</th><th>h_flg_k20fe</th><th>k_m_k20fe</th><th>k_msig_k20fe</th><th>k_flg_k20fe</th><th>k_ba</th><th>k_phi</th><th>sup_ba</th><th>sup_phi</th><th>r_ext</th><th>j_m_ext</th><th>j_msig_ext</th><th>h_m_ext</th><th>h_msig_ext</th><th>k_m_ext</th><th>k_msig_ext</th><th>cc_flg</th><th>dist</th><th>angle</th></tr></thead>
<thead><tr><th></th><th>deg</th><th>deg</th><th>arcsec</th><th>mag</th><th>mag</th><th></th><th>mag</th><th>mag</th><th></th><th>mag</th><th>mag</th><th></th><th></th><th>deg</th><th></th><th>deg</th><th>arcsec</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th></th><th>arcsec</th><th>deg</th></tr></thead>
<thead><tr><th>str16</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>int64</th><th>float64</th><th>int64</th><th>float64</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str1</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>00402069+0052508</td><td>10.086218</td><td>0.880798</td><td>9.4</td><td>13.835</td><td>0.068</td><td>0</td><td>13.01</td><td>0.086</td><td>0</td><td>12.588</td><td>0.089</td><td>0</td><td>0.8</td><td>70</td><td>0.82</td><td>35</td><td>18.62</td><td>13.632</td><td>0.088</td><td>12.744</td><td>0.104</td><td>12.398</td><td>0.105</td><td>0</td><td>972.120611</td><td>91.538952</td></tr>
<tr><td>00395984+0103545</td><td>9.99935</td><td>1.06514</td><td>12.9</td><td>12.925</td><td>0.035</td><td>0</td><td>12.183</td><td>0.042</td><td>0</td><td>11.89</td><td>0.067</td><td>0</td><td>0.8</td><td>35</td><td>0.7</td><td>40</td><td>35.9</td><td>12.469</td><td>0.048</td><td>11.91</td><td>0.066</td><td>11.522</td><td>0.087</td><td>0</td><td>916.927636</td><td>45.951861</td></tr>
<tr><td>00401849+0049448</td><td>10.077062</td><td>0.82913</td><td>6.0</td><td>14.918</td><td>0.086</td><td>0</td><td>14.113</td><td>0.107</td><td>0</td><td>13.714</td><td>0.103</td><td>0</td><td>0.6</td><td>-15</td><td>1.0</td><td>90</td><td>11.35</td><td>14.631</td><td>0.121</td><td>13.953</td><td>0.169</td><td>13.525</td><td>0.161</td><td>0</td><td>962.489231</td><td>102.73149</td></tr>
<tr><td>00395277+0057124</td><td>9.969907</td><td>0.953472</td><td>5.3</td><td>14.702</td><td>0.049</td><td>0</td><td>14.248</td><td>0.069</td><td>0</td><td>13.899</td><td>0.095</td><td>0</td><td>0.6</td><td>-60</td><td>0.44</td><td>-50</td><td>10.59</td><td>14.62</td><td>0.144</td><td>14.15</td><td>0.296</td><td>13.73</td><td>0.2</td><td>0</td><td>601.136444</td><td>66.93659</td></tr>
<tr><td>00401864+0047245</td><td>10.077704</td><td>0.790143</td><td>7.6</td><td>15.585</td><td>0.134</td><td>1</td><td>15.003</td><td>0.18</td><td>1</td><td>14.049</td><td>0.142</td><td>1</td><td>0.5</td><td>30</td><td>0.46</td><td>30</td><td>14.48</td><td>14.977</td><td>0.138</td><td>14.855</td><td>0.303</td><td>13.653</td><td>0.18</td><td>0</td><td>1004.982128</td><td>110.53147</td></tr>
<tr><td>00393485+0051355</td><td>9.895219</td><td>0.859882</td><td>39.3</td><td>11.415</td><td>0.031</td><td>3</td><td>10.755</td><td>0.044</td><td>3</td><td>10.514</td><td>0.068</td><td>3</td><td>0.6</td><td>-30</td><td>0.7</td><td>-60</td><td>92.29</td><td>11.415</td><td>0.018</td><td>10.155</td><td>0.054</td><td>9.976</td><td>0.085</td><td>0</td><td>301.813395</td><td>109.639102</td></tr>
<tr><td>00392964+0103495</td><td>9.873526</td><td>1.063769</td><td>10.9</td><td>14.463</td><td>0.065</td><td>0</td><td>13.618</td><td>0.067</td><td>0</td><td>13.258</td><td>0.091</td><td>0</td><td>0.4</td><td>55</td><td>0.28</td><td>60</td><td>20.35</td><td>14.2</td><td>0.086</td><td>13.363</td><td>0.091</td><td>13.101</td><td>0.133</td><td>0</td><td>665.301415</td><td>18.051526</td></tr>
<tr><td>00403343+0049079</td><td>10.139293</td><td>0.818865</td><td>5.0</td><td>15.484</td><td>0.15</td><td>0</td><td>--</td><td>--</td><td>--</td><td>13.97</td><td>0.137</td><td>0</td><td>1.0</td><td>90</td><td>1.0</td><td>90</td><td>10.05</td><td>15.035</td><td>0.183</td><td>14.725</td><td>0.0</td><td>13.654</td><td>0.189</td><td>0</td><td>1189.207905</td><td>102.088788</td></tr>
<tr><td>00393319+0035505</td><td>9.888305</td><td>0.597381</td><td>11.5</td><td>13.156</td><td>0.033</td><td>0</td><td>12.509</td><td>0.043</td><td>0</td><td>12.073</td><td>0.059</td><td>0</td><td>0.6</td><td>-55</td><td>0.52</td><td>-40</td><td>21.64</td><td>13.026</td><td>0.04</td><td>12.247</td><td>0.046</td><td>11.978</td><td>0.065</td><td>0</td><td>1078.11027</td><td>166.0785</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>00391798+0041588</td><td>9.824936</td><td>0.699687</td><td>6.1</td><td>15.685</td><td>0.168</td><td>0</td><td>14.89</td><td>0.191</td><td>0</td><td>14.003</td><td>0.155</td><td>0</td><td>1.0</td><td>90</td><td>1.0</td><td>90</td><td>11.4</td><td>15.677</td><td>0.312</td><td>14.415</td><td>0.226</td><td>13.568</td><td>0.19</td><td>0</td><td>678.863209</td><td>177.360117</td></tr>
<tr><td>00384796+0034572</td><td>9.699858</td><td>0.582578</td><td>5.1</td><td>14.925</td><td>0.077</td><td>0</td><td>14.224</td><td>0.114</td><td>0</td><td>13.536</td><td>0.079</td><td>0</td><td>1.0</td><td>90</td><td>1.0</td><td>90</td><td>10.2</td><td>14.839</td><td>0.133</td><td>14.111</td><td>0.192</td><td>13.461</td><td>0.137</td><td>0</td><td>1176.842625</td><td>200.856597</td></tr>
<tr><td>00390392+0050579</td><td>9.766345</td><td>0.849419</td><td>5.0</td><td>14.895</td><td>0.07</td><td>0</td><td>14.238</td><td>0.087</td><td>0</td><td>13.834</td><td>0.11</td><td>0</td><td>1.0</td><td>90</td><td>1.0</td><td>90</td><td>10.05</td><td>14.706</td><td>0.107</td><td>14.033</td><td>0.132</td><td>13.75</td><td>0.187</td><td>0</td><td>227.201453</td><td>232.24689</td></tr>
<tr><td>00391339+0051508</td><td>9.805797</td><td>0.864135</td><td>52.8</td><td>10.362</td><td>0.014</td><td>0</td><td>9.631</td><td>0.017</td><td>0</td><td>9.334</td><td>0.024</td><td>0</td><td>0.3</td><td>-15</td><td>0.4</td><td>-15</td><td>75.02</td><td>10.279</td><td>0.015</td><td>9.527</td><td>0.016</td><td>9.247</td><td>0.023</td><td>0</td><td>93.990015</td><td>203.598476</td></tr>
<tr><td>00391786+0054458</td><td>9.824418</td><td>0.912743</td><td>27.9</td><td>11.082</td><td>0.016</td><td>0</td><td>10.384</td><td>0.022</td><td>0</td><td>10.147</td><td>0.032</td><td>0</td><td>0.5</td><td>5</td><td>0.7</td><td>5</td><td>42.75</td><td>10.914</td><td>0.018</td><td>10.251</td><td>0.021</td><td>10.031</td><td>0.03</td><td>0</td><td>93.596555</td><td>18.308033</td></tr>
<tr><td>00385879+0057269</td><td>9.744971</td><td>0.957478</td><td>5.0</td><td>15.535</td><td>0.122</td><td>0</td><td>14.796</td><td>0.145</td><td>0</td><td>14.278</td><td>0.165</td><td>0</td><td>1.0</td><td>90</td><td>1.0</td><td>90</td><td>10.05</td><td>15.535</td><td>0.122</td><td>14.623</td><td>0.227</td><td>14.147</td><td>0.269</td><td>0</td><td>358.163568</td><td>314.246475</td></tr>
<tr><td>00391879+0053308</td><td>9.828303</td><td>0.891909</td><td>15.4</td><td>13.044</td><td>0.047</td><td>0</td><td>12.412</td><td>0.063</td><td>0</td><td>12.077</td><td>0.094</td><td>0</td><td>0.8</td><td>60</td><td>0.74</td><td>65</td><td>23.62</td><td>12.755</td><td>0.048</td><td>12.283</td><td>0.072</td><td>11.713</td><td>0.096</td><td>0</td><td>45.544562</td><td>72.287562</td></tr>
<tr><td>00391213+0102408</td><td>9.80055</td><td>1.044691</td><td>5.0</td><td>15.568</td><td>0.126</td><td>0</td><td>15.047</td><td>0.181</td><td>0</td><td>14.356</td><td>0.176</td><td>0</td><td>1.0</td><td>90</td><td>1.0</td><td>90</td><td>10.05</td><td>15.295</td><td>0.181</td><td>15.047</td><td>0.181</td><td>14.067</td><td>0.25</td><td>0</td><td>566.696375</td><td>354.276982</td></tr>
<tr><td>00383990+0104442</td><td>9.666268</td><td>1.078968</td><td>5.3</td><td>15.255</td><td>0.108</td><td>0</td><td>14.232</td><td>0.121</td><td>0</td><td>13.873</td><td>0.113</td><td>0</td><td>1.0</td><td>90</td><td>1.0</td><td>90</td><td>10.44</td><td>15.151</td><td>0.18</td><td>13.812</td><td>0.149</td><td>13.552</td><td>0.155</td><td>0</td><td>873.946372</td><td>321.851314</td></tr>
<tr><td>00384916+0050212</td><td>9.704872</td><td>0.839244</td><td>5.1</td><td>15.075</td><td>0.088</td><td>0</td><td>14.651</td><td>0.17</td><td>0</td><td>13.804</td><td>0.101</td><td>0</td><td>1.0</td><td>90</td><td>1.0</td><td>90</td><td>10.2</td><td>15.053</td><td>0.159</td><td>14.651</td><td>0.17</td><td>13.682</td><td>0.171</td><td>0</td><td>437.740484</td><td>246.331036</td></tr>
</table></div>
</div>
<p>OK, looks like they both have <code class="docutils literal"><span class="pre">ra</span></code> and <code class="docutils literal"><span class="pre">dec</span></code> columns, so we should
be able to use that to make <code class="docutils literal"><span class="pre">SkyCoord</span></code>s.</p>
<p>You might first think you need to create a separate <code class="docutils literal"><span class="pre">SkyCoord</span></code> for
<em>every</em> row in the table, given that up until now all <code class="docutils literal"><span class="pre">SkyCoord</span></code>s we
made were for just a single point. You could do this, but it will make
your code much slower. Instead, <code class="docutils literal"><span class="pre">SkyCoord</span></code> supports <em>arrays</em> of
coordinate values - you just pass in array-like inputs (array
<code class="docutils literal"><span class="pre">Quantity</span></code>s, lists of strings, <code class="docutils literal"><span class="pre">Table</span></code> columns, etc.), and
<code class="docutils literal"><span class="pre">SkyCoord</span></code> will happily do all of its operations element-wise.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">coo_sdss</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">sdss</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">sdss</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
<span class="n">coo_twomass</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">twomass</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">twomass</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Note a subtle difference here: you had to give units for SDSS but <em>not</em>
for 2MASS. This is because the 2MASS table has units associated with the
columns, while the SDSS table does not (so you have to put them in
manually).</p>
<p>Now we simply use the <code class="docutils literal"><span class="pre">SkyCoord.match_to_catalog_sky</span></code> method to match
the two catalogs. Note that order matters: we’re matching 2MASS to SDSS
because there are many <em>more</em> entires in the SDSS, so it seems likely
that most 2MASS objects are in SDSS (but not vice versa).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">idx_sdss</span><span class="p">,</span> <span class="n">d2d_sdss</span><span class="p">,</span> <span class="n">d3d_sdss</span> <span class="o">=</span> <span class="n">coo_twomass</span><span class="o">.</span><span class="n">match_to_catalog_sky</span><span class="p">(</span><span class="n">coo_sdss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-20-c1ca95a64753&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>idx_sdss<span class="ansi-blue-fg">,</span> d2d_sdss<span class="ansi-blue-fg">,</span> d3d_sdss <span class="ansi-blue-fg">=</span> coo_twomass<span class="ansi-blue-fg">.</span>match_to_catalog_sky<span class="ansi-blue-fg">(</span>coo_sdss<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda/envs/tutorials-dev/lib/python3.6/site-packages/astropy/coordinates/sky_coordinate.py</span> in <span class="ansi-cyan-fg">match_to_catalog_sky</span><span class="ansi-blue-fg">(self, catalogcoord, nthneighbor)</span>
<span class="ansi-green-intense-fg ansi-bold">    903</span>         res = match_coordinates_sky(self_in_catalog_frame, catalogcoord,
<span class="ansi-green-intense-fg ansi-bold">    904</span>                                     nthneighbor<span class="ansi-blue-fg">=</span>nthneighbor<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 905</span><span class="ansi-red-fg">                                     storekdtree=&#39;_kdtree_sky&#39;)
</span><span class="ansi-green-intense-fg ansi-bold">    906</span>         <span class="ansi-green-fg">return</span> res
<span class="ansi-green-intense-fg ansi-bold">    907</span>

<span class="ansi-green-fg">~/anaconda/envs/tutorials-dev/lib/python3.6/site-packages/astropy/coordinates/matching.py</span> in <span class="ansi-cyan-fg">match_coordinates_sky</span><span class="ansi-blue-fg">(matchcoord, catalogcoord, nthneighbor, storekdtree)</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span>     storekdtree <span class="ansi-blue-fg">=</span> catalogcoord<span class="ansi-blue-fg">.</span>cache<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span>storekdtree<span class="ansi-blue-fg">,</span> storekdtree<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span>
<span class="ansi-green-fg">--&gt; 157</span><span class="ansi-red-fg">     </span>idx<span class="ansi-blue-fg">,</span> sep2d<span class="ansi-blue-fg">,</span> sep3d <span class="ansi-blue-fg">=</span> match_coordinates_3d<span class="ansi-blue-fg">(</span>newmatch_u<span class="ansi-blue-fg">,</span> newcat_u<span class="ansi-blue-fg">,</span> nthneighbor<span class="ansi-blue-fg">,</span> storekdtree<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    158</span>     <span class="ansi-red-fg"># sep3d is *wrong* above, because the distance information was removed,</span>
<span class="ansi-green-intense-fg ansi-bold">    159</span>     <span class="ansi-red-fg"># unless one of the catalogs doesn&#39;t have a real distance</span>

<span class="ansi-green-fg">~/anaconda/envs/tutorials-dev/lib/python3.6/site-packages/astropy/coordinates/matching.py</span> in <span class="ansi-cyan-fg">match_coordinates_3d</span><span class="ansi-blue-fg">(matchcoord, catalogcoord, nthneighbor, storekdtree)</span>
<span class="ansi-green-intense-fg ansi-bold">     68</span>                          &#39;scalar or length-0.&#39;)
<span class="ansi-green-intense-fg ansi-bold">     69</span>
<span class="ansi-green-fg">---&gt; 70</span><span class="ansi-red-fg">     </span>kdt <span class="ansi-blue-fg">=</span> _get_cartesian_kdtree<span class="ansi-blue-fg">(</span>catalogcoord<span class="ansi-blue-fg">,</span> storekdtree<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     71</span>
<span class="ansi-green-intense-fg ansi-bold">     72</span>     <span class="ansi-red-fg"># make sure coordinate systems match</span>

<span class="ansi-green-fg">~/anaconda/envs/tutorials-dev/lib/python3.6/site-packages/astropy/coordinates/matching.py</span> in <span class="ansi-cyan-fg">_get_cartesian_kdtree</span><span class="ansi-blue-fg">(coord, attrname_or_kdt, forceunit)</span>
<span class="ansi-green-intense-fg ansi-bold">    429</span>
<span class="ansi-green-intense-fg ansi-bold">    430</span>     <span class="ansi-red-fg"># without scipy this will immediately fail</span>
<span class="ansi-green-fg">--&gt; 431</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">from</span> scipy <span class="ansi-green-fg">import</span> spatial
<span class="ansi-green-intense-fg ansi-bold">    432</span>     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    433</span>         KDTree <span class="ansi-blue-fg">=</span> spatial<span class="ansi-blue-fg">.</span>cKDTree

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;scipy&#39;
</pre></div></div>
</div>
<p><code class="docutils literal"><span class="pre">idx</span></code> are the indecies into <code class="docutils literal"><span class="pre">coo_sdss</span></code> that get the closest matches,
while <code class="docutils literal"><span class="pre">d2d</span></code> and <code class="docutils literal"><span class="pre">d3d</span></code> are the on-sky and real-space distances
between the matches. In our case <code class="docutils literal"><span class="pre">d3d</span></code> can be ignored because we
didn’t give a line-of-sight distance, so its value is not particularly
useful. But <code class="docutils literal"><span class="pre">d2d</span></code> provides a good diagnosis of whether we actually
have real matches:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">d2d_sdss</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;separation [arcsec]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-21-e6f95c438532&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>plt<span class="ansi-blue-fg">.</span>hist<span class="ansi-blue-fg">(</span>d2d_sdss<span class="ansi-blue-fg">.</span>arcsec<span class="ansi-blue-fg">,</span> histtype<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;step&#39;</span><span class="ansi-blue-fg">,</span> range<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> plt<span class="ansi-blue-fg">.</span>xlabel<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;separation [arcsec]&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> plt<span class="ansi-blue-fg">.</span>tight_layout<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;d2d_sdss&#39; is not defined
</pre></div></div>
</div>
<p>Ok, they’re all within an arcsecond that’s promising. But are we sure
it’s not just that <em>anything</em> has matches within an arcescond? Lets
check by comparing to a set of <em>random</em> points.</p>
<p>We first create a set of uniformly random points (with size matching
<code class="docutils literal"><span class="pre">coo_twomass</span></code>) that cover the same range of RA/Decs that are in
<code class="docutils literal"><span class="pre">coo_sdss</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">ras_sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coo_twomass</span><span class="p">))</span><span class="o">*</span><span class="n">coo_sdss</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">ptp</span><span class="p">()</span> <span class="o">+</span> <span class="n">coo_sdss</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">decs_sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coo_twomass</span><span class="p">))</span><span class="o">*</span><span class="n">coo_sdss</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">ptp</span><span class="p">()</span> <span class="o">+</span> <span class="n">coo_sdss</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">ras_sim</span><span class="p">,</span> <span class="n">decs_sim</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[22]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>(&lt;Angle [  9.52999692,  9.78016847, 10.17735876,  9.9167734 ,  9.88706975,
           9.77614416,  9.85980572,  9.52220661,  9.66042338,  9.61678406,
          10.11855255,  9.66756346, 10.10714953,  9.90792039,  9.54386259,
           9.57327219, 10.16967207, 10.17341717,  9.7230053 ,  9.85607755,
          10.07310392, 10.16228298,  9.76869456] deg&gt;,
 &lt;Angle [ 0.67378821, 1.15800508, 0.99639175, 0.65498832, 0.90986518,
          0.9670662 , 0.75213698, 0.84403027, 0.64672732, 0.7129828 ,
          0.95604791, 0.90587827, 0.87477653, 0.64225821, 0.91070648,
          0.96324346, 0.55107079, 0.86246392, 0.66809696, 0.8646065 ,
          0.56873901, 0.88534664, 1.02339233] deg&gt;)
</pre></div>
</div>
</div>
<p>Now we create a <code class="docutils literal"><span class="pre">SkyCoord</span></code> from these points and match it to
<code class="docutils literal"><span class="pre">coo_sdss</span></code> just like we did above for 2MASS.</p>
<p>Note that we do not need to explicitly specify units for <code class="docutils literal"><span class="pre">ras_sim</span></code> and
<code class="docutils literal"><span class="pre">decs_sim</span></code>, because they already are unitful <code class="docutils literal"><span class="pre">Angle</span></code> objects because
they were created from <code class="docutils literal"><span class="pre">coo_sdss.ra</span></code>/<code class="docutils literal"><span class="pre">coo_sdss.dec</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">coo_simulated</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ras_sim</span><span class="p">,</span> <span class="n">decs_sim</span><span class="p">)</span>
<span class="n">idx_sim</span><span class="p">,</span> <span class="n">d2d_sim</span><span class="p">,</span> <span class="n">d3d_sim</span> <span class="o">=</span> <span class="n">coo_simulated</span><span class="o">.</span><span class="n">match_to_catalog_sky</span><span class="p">(</span><span class="n">coo_sdss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-23-0122a58915ce&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> coo_simulated <span class="ansi-blue-fg">=</span> SkyCoord<span class="ansi-blue-fg">(</span>ras_sim<span class="ansi-blue-fg">,</span> decs_sim<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>idx_sim<span class="ansi-blue-fg">,</span> d2d_sim<span class="ansi-blue-fg">,</span> d3d_sim <span class="ansi-blue-fg">=</span> coo_simulated<span class="ansi-blue-fg">.</span>match_to_catalog_sky<span class="ansi-blue-fg">(</span>coo_sdss<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda/envs/tutorials-dev/lib/python3.6/site-packages/astropy/coordinates/sky_coordinate.py</span> in <span class="ansi-cyan-fg">match_to_catalog_sky</span><span class="ansi-blue-fg">(self, catalogcoord, nthneighbor)</span>
<span class="ansi-green-intense-fg ansi-bold">    903</span>         res = match_coordinates_sky(self_in_catalog_frame, catalogcoord,
<span class="ansi-green-intense-fg ansi-bold">    904</span>                                     nthneighbor<span class="ansi-blue-fg">=</span>nthneighbor<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 905</span><span class="ansi-red-fg">                                     storekdtree=&#39;_kdtree_sky&#39;)
</span><span class="ansi-green-intense-fg ansi-bold">    906</span>         <span class="ansi-green-fg">return</span> res
<span class="ansi-green-intense-fg ansi-bold">    907</span>

<span class="ansi-green-fg">~/anaconda/envs/tutorials-dev/lib/python3.6/site-packages/astropy/coordinates/matching.py</span> in <span class="ansi-cyan-fg">match_coordinates_sky</span><span class="ansi-blue-fg">(matchcoord, catalogcoord, nthneighbor, storekdtree)</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span>     storekdtree <span class="ansi-blue-fg">=</span> catalogcoord<span class="ansi-blue-fg">.</span>cache<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span>storekdtree<span class="ansi-blue-fg">,</span> storekdtree<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span>
<span class="ansi-green-fg">--&gt; 157</span><span class="ansi-red-fg">     </span>idx<span class="ansi-blue-fg">,</span> sep2d<span class="ansi-blue-fg">,</span> sep3d <span class="ansi-blue-fg">=</span> match_coordinates_3d<span class="ansi-blue-fg">(</span>newmatch_u<span class="ansi-blue-fg">,</span> newcat_u<span class="ansi-blue-fg">,</span> nthneighbor<span class="ansi-blue-fg">,</span> storekdtree<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    158</span>     <span class="ansi-red-fg"># sep3d is *wrong* above, because the distance information was removed,</span>
<span class="ansi-green-intense-fg ansi-bold">    159</span>     <span class="ansi-red-fg"># unless one of the catalogs doesn&#39;t have a real distance</span>

<span class="ansi-green-fg">~/anaconda/envs/tutorials-dev/lib/python3.6/site-packages/astropy/coordinates/matching.py</span> in <span class="ansi-cyan-fg">match_coordinates_3d</span><span class="ansi-blue-fg">(matchcoord, catalogcoord, nthneighbor, storekdtree)</span>
<span class="ansi-green-intense-fg ansi-bold">     68</span>                          &#39;scalar or length-0.&#39;)
<span class="ansi-green-intense-fg ansi-bold">     69</span>
<span class="ansi-green-fg">---&gt; 70</span><span class="ansi-red-fg">     </span>kdt <span class="ansi-blue-fg">=</span> _get_cartesian_kdtree<span class="ansi-blue-fg">(</span>catalogcoord<span class="ansi-blue-fg">,</span> storekdtree<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     71</span>
<span class="ansi-green-intense-fg ansi-bold">     72</span>     <span class="ansi-red-fg"># make sure coordinate systems match</span>

<span class="ansi-green-fg">~/anaconda/envs/tutorials-dev/lib/python3.6/site-packages/astropy/coordinates/matching.py</span> in <span class="ansi-cyan-fg">_get_cartesian_kdtree</span><span class="ansi-blue-fg">(coord, attrname_or_kdt, forceunit)</span>
<span class="ansi-green-intense-fg ansi-bold">    429</span>
<span class="ansi-green-intense-fg ansi-bold">    430</span>     <span class="ansi-red-fg"># without scipy this will immediately fail</span>
<span class="ansi-green-fg">--&gt; 431</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">from</span> scipy <span class="ansi-green-fg">import</span> spatial
<span class="ansi-green-intense-fg ansi-bold">    432</span>     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    433</span>         KDTree <span class="ansi-blue-fg">=</span> spatial<span class="ansi-blue-fg">.</span>cKDTree

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;scipy&#39;
</pre></div></div>
</div>
<p>Now lets plot up the histogram of separations from our simulated catalog
so we can compare to the above results from the <em>real</em> catalog.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">d2d_sim</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulated&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">d2d_sdss</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2MASS&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;separation [arcsec]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-24-870f7ae6b3b4&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>plt<span class="ansi-blue-fg">.</span>hist<span class="ansi-blue-fg">(</span>d2d_sim<span class="ansi-blue-fg">.</span>arcsec<span class="ansi-blue-fg">,</span> bins<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;auto&#39;</span><span class="ansi-blue-fg">,</span> histtype<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;step&#39;</span><span class="ansi-blue-fg">,</span> label<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;Simulated&#39;</span><span class="ansi-blue-fg">,</span> linestyle<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;dashed&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> plt<span class="ansi-blue-fg">.</span>hist<span class="ansi-blue-fg">(</span>d2d_sdss<span class="ansi-blue-fg">.</span>arcsec<span class="ansi-blue-fg">,</span> bins<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;auto&#39;</span><span class="ansi-blue-fg">,</span> histtype<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;step&#39;</span><span class="ansi-blue-fg">,</span> label<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;2MASS&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> plt<span class="ansi-blue-fg">.</span>xlabel<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;separation [arcsec]&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> plt<span class="ansi-blue-fg">.</span>legend<span class="ansi-blue-fg">(</span>loc<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> plt<span class="ansi-blue-fg">.</span>tight_layout<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;d2d_sim&#39; is not defined
</pre></div></div>
</div>
<p>Alright, great - looks like randomly placed sources should be more like
an arc<em>minute</em> away, so we can probably trust that our earlier matches
which were within an arc<em>second</em> are valid. So with that in mind, we
can start computing things like colors that combine the SDSS and 2MASS
photometry.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">rmag</span> <span class="o">=</span> <span class="n">sdss</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="n">idx_sdss</span><span class="p">]</span>
<span class="n">grcolor</span> <span class="o">=</span> <span class="n">sdss</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">][</span><span class="n">idx_sdss</span><span class="p">]</span> <span class="o">-</span> <span class="n">rmag</span>
<span class="n">rKcolor</span> <span class="o">=</span> <span class="n">rmag</span> <span class="o">-</span> <span class="n">twomass</span><span class="p">[</span><span class="s1">&#39;k_m_ext&#39;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rKcolor</span><span class="p">,</span> <span class="n">rmag</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;r-K&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="c1">#mags go backwards!</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rKcolor</span><span class="p">,</span> <span class="n">rmag</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;r-K&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;g-r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-25-f9ff03149327&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>rmag <span class="ansi-blue-fg">=</span> sdss<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;r&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span>idx_sdss<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> grcolor <span class="ansi-blue-fg">=</span> sdss<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;g&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span>idx_sdss<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">-</span> rmag
<span class="ansi-green-intense-fg ansi-bold">      3</span> rKcolor <span class="ansi-blue-fg">=</span> rmag <span class="ansi-blue-fg">-</span> twomass<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;k_m_ext&#39;</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> plt<span class="ansi-blue-fg">.</span>subplot<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;idx_sdss&#39; is not defined
</pre></div></div>
</div>
<p>For more on what matching options are available, check out the
<a class="reference external" href="http://astropy.readthedocs.org/en/latest/coordinates/matchsep.html">separation and matching section of the astropy
documentation</a>.
Or for more on what you can do with <code class="docutils literal"><span class="pre">SkyCoord</span></code>, see <a class="reference external" href="http://astropy.readthedocs.org/en/latest/api/astropy.coordinates.SkyCoord.html">its API
documentation</a>.</p>
<div class="section" id="Exercises">
<h3>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h3>
<p>Check that the <code class="docutils literal"><span class="pre">d2d_sdss</span></code> variable matches the on-sky separations you
get from comaparing the matched <code class="docutils literal"><span class="pre">coo_sdss</span></code> entries to <code class="docutils literal"><span class="pre">coo_twomass</span></code>.</p>
<p>Hint: You’ll likely find the <code class="docutils literal"><span class="pre">SkyCoord.separation()</span></code> method useful
here.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p>Compute the <em>physical</em> separation between two (or more) objects in the
catalogs. You’ll need line-of-sight distances, so a reasonable guess
might be the distance to HCG 7, which is about 55 Mpc.</p>
<p>Hint: you’ll want to create new <code class="docutils literal"><span class="pre">SkyCoord</span></code> objects, but with
<code class="docutils literal"><span class="pre">distance</span></code> attributes. There’s also a <code class="docutils literal"><span class="pre">SkyCoord</span></code> method that should
do the rest of the work, but you’ll have to poke around to figure out
what it is.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Transforming-between-coordinate-systems-and-planning-observations">
<h2>Transforming between coordinate systems and planning observations<a class="headerlink" href="#Transforming-between-coordinate-systems-and-planning-observations" title="Permalink to this headline">¶</a></h2>
<p>Now lets say something excites you about one of the objects in this
catalog, and you want to know if and when you might go about observing
it. <code class="docutils literal"><span class="pre">astropy.coordinates</span></code> provides tools to enable this, as well.</p>
<div class="section" id="Introducting-frame-transformations">
<h3>Introducting frame transformations<a class="headerlink" href="#Introducting-frame-transformations" title="Permalink to this headline">¶</a></h3>
<p>To understand the code in this section, it may help to read over the
<a class="reference external" href="http://astropy.readthedocs.org/en/latest/coordinates/index.html#overview-of-astropy-coordinates-concepts">overview of the astropy coordinates
scheme</a>.
The key bit to understand is that all coordinates in astropy are in
particular “frames”, and we can transform between a specific
<code class="docutils literal"><span class="pre">SkyCoord</span></code> object from one frame to another. For example, we can
transform our previously-defined center of HCG7 from ICRS to Galactic
coordinates:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hcg7_center</span><span class="o">.</span><span class="n">galactic</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[26]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;SkyCoord (Galactic): (l, b) in deg
    ( 116.54378751, -61.84415576)&gt;
</pre></div>
</div>
</div>
<p>The above is actually a special “quick-access” form which internally
does the same as what’s in the cell below: uses the <code class="docutils literal"><span class="pre">transform_to()</span></code>
method to convert from one frame to another.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">Galactic</span>
<span class="n">hcg7_center</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">Galactic</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[27]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;SkyCoord (Galactic): (l, b) in deg
    ( 116.54378751, -61.84415576)&gt;
</pre></div>
</div>
</div>
<p>Note that changing frames also changes some of the attributes of the
object, but usually in a way that makes sense:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hcg7_center</span><span class="o">.</span><span class="n">galactic</span><span class="o">.</span><span class="n">ra</span>  <span class="c1"># should fail because galactic coordinates are l/b not RA/Dec</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-28-d7bc134707f6&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>hcg7_center<span class="ansi-blue-fg">.</span>galactic<span class="ansi-blue-fg">.</span>ra  <span class="ansi-red-fg"># should fail because galactic coordinates are l/b not RA/Dec</span>

<span class="ansi-green-fg">~/anaconda/envs/tutorials-dev/lib/python3.6/site-packages/astropy/coordinates/sky_coordinate.py</span> in <span class="ansi-cyan-fg">__getattr__</span><span class="ansi-blue-fg">(self, attr)</span>
<span class="ansi-green-intense-fg ansi-bold">    518</span>         <span class="ansi-red-fg"># Fail</span>
<span class="ansi-green-intense-fg ansi-bold">    519</span>         raise AttributeError(&#34;&#39;{0}&#39; object has no attribute &#39;{1}&#39;&#34;
<span class="ansi-green-fg">--&gt; 520</span><span class="ansi-red-fg">                              .format(self.__class__.__name__, attr))
</span><span class="ansi-green-intense-fg ansi-bold">    521</span>
<span class="ansi-green-intense-fg ansi-bold">    522</span>     <span class="ansi-green-fg">def</span> __setattr__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> attr<span class="ansi-blue-fg">,</span> val<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">AttributeError</span>: &#39;SkyCoord&#39; object has no attribute &#39;ra&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hcg7_center</span><span class="o">.</span><span class="n">galactic</span><span class="o">.</span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math">
<p><img src="../../_images/math/9de565b90877da8e8b6c3cc5b13068e214d95bc8.png" alt="$-61^\circ50{}^\prime38.9607{}^{\prime\prime}$"/></p>
</div></div>
</div>
</div>
<div class="section" id="Using-frame-transformations-to-get-to-AltAz">
<h3>Using frame transformations to get to AltAz<a class="headerlink" href="#Using-frame-transformations-to-get-to-AltAz" title="Permalink to this headline">¶</a></h3>
<p>To actually do anything with observability we need to convert to a frame
local to an on-earth observer. By far the most common choice is
horizontal coordinates, or “AltAz” coordinates. We first need to specify
both where and when we want to try to observe.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">EarthLocation</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>

<span class="n">observing_location</span> <span class="o">=</span> <span class="n">EarthLocation</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="s1">&#39;31d57.5m&#39;</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="s1">&#39;-111d35.8m&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">2096</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># Kitt Peak, Arizona</span>
<span class="c1"># If you&#39;re using astropy v1.1 or later, you can replace the above with this:</span>
<span class="c1">#observing_location = EarthLocation.of_site(&#39;Kitt Peak&#39;)</span>

<span class="n">observing_time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="s1">&#39;2010-12-21 1:00&#39;</span><span class="p">)</span>  <span class="c1"># 1am UTC=6pm AZ mountain time</span>
</pre></div>
</div>
</div>
<p>Now we use these to create an <code class="docutils literal"><span class="pre">AltAz</span></code> frame object. Note that this
frame has some other information about the atmosphere, which can be used
to correct for atmospheric refraction. Here we leave that alone, because
the default is to ignore this effect (by setting the pressure to 0).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">AltAz</span>

<span class="n">aa</span> <span class="o">=</span> <span class="n">AltAz</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">observing_location</span><span class="p">,</span> <span class="n">obstime</span><span class="o">=</span><span class="n">observing_time</span><span class="p">)</span>
<span class="n">aa</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[31]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;AltAz Frame (obstime=2010-12-21 01:00:00.000, location=(-1994310.09211632, -5037908.606337594, 3357621.752122168) m, pressure=0.0 hPa, temperature=0.0 deg_C, relative_humidity=0, obswl=1.0 micron)&gt;
</pre></div>
</div>
</div>
<p>Now we can just transform our ICRS <code class="docutils literal"><span class="pre">SkyCoord</span></code> to <code class="docutils literal"><span class="pre">AltAz</span></code> to get the
location in the sky over Kitt Peak at the requested time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">hcg7_center</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">aa</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[32]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;SkyCoord (AltAz: obstime=2010-12-21 01:00:00.000, location=(-1994310.09211632, -5037908.606337594, 3357621.752122168) m, pressure=0.0 hPa, temperature=0.0 deg_C, relative_humidity=0, obswl=1.0 micron): (az, alt) in deg
    ( 149.14900938,  55.03905882)&gt;
</pre></div>
</div>
</div>
<p>Alright, it’s up at 6pm, but that’s pretty early to be observing. We
could just try various times one at a time to see if the airmass is at a
darker time, but we can do better: lets try to create an airmass plot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># this gives a Time object with an *array* of times</span>
<span class="n">delta_hours</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">hour</span>
<span class="n">full_night_times</span> <span class="o">=</span> <span class="n">observing_time</span> <span class="o">+</span> <span class="n">delta_hours</span>
<span class="n">full_night_aa_frames</span> <span class="o">=</span> <span class="n">AltAz</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">observing_location</span><span class="p">,</span> <span class="n">obstime</span><span class="o">=</span><span class="n">full_night_times</span><span class="p">)</span>
<span class="n">full_night_aa_coos</span> <span class="o">=</span> <span class="n">hcg7_center</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">full_night_aa_frames</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">delta_hours</span><span class="p">,</span> <span class="n">full_night_aa_coos</span><span class="o">.</span><span class="n">secz</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hours from 6pm AZ time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Airmass [Sec(z)]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_coordinates_coordinates_78_0.png" src="../../_images/tutorials_coordinates_coordinates_78_0.png" />
</div>
</div>
<p>Great! Looks like it’s at the lowest airmass in another hour or so
(7pm). But might that might still be twilight… When should we start
observing for proper dark skies? Fortunately, astropy provides a
<code class="docutils literal"><span class="pre">get_sun</span></code> function that can be used to check this. Lets use it to
check if we’re in 18-degree twilight or not.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">get_sun</span>

<span class="n">full_night_sun_coos</span> <span class="o">=</span> <span class="n">get_sun</span><span class="p">(</span><span class="n">full_night_times</span><span class="p">)</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">full_night_aa_frames</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">delta_hours</span><span class="p">,</span> <span class="n">full_night_sun_coos</span><span class="o">.</span><span class="n">alt</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hours from 6pm AZ time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sun altitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_coordinates_coordinates_80_0.png" src="../../_images/tutorials_coordinates_coordinates_80_0.png" />
</div>
</div>
<p>Looks like it’s just below 18 degrees at 7, so you should be good to go!</p>
</div>
<div class="section" id="Exercises">
<h3>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h3>
<p>Try to actually compute to some arbitrary precision (rather than
eye-balling on a plot) when 18 degree twilight or sunrise/sunset hits on
that night.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p>Try converting the HCG7 coordinates to an equatorial frame at some other
equinox a while in the past (like J2000). Do you see the precession of
the equinoxes?</p>
<p>Hint: To see a diagram of the supported frames look
<a class="reference external" href="http://docs.astropy.org/en/stable/coordinates/#module-astropy.coordinates">here</a>.
One of those will do what you need if you give it the right frame
attributes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Wrap-up">
<h2>Wrap-up<a class="headerlink" href="#Wrap-up" title="Permalink to this headline">¶</a></h2>
<p>For lots more documentation on the many other features of
<code class="docutils literal"><span class="pre">astropy.coordinates</span></code>, check out <a class="reference external" href="http://astropy.readthedocs.org/en/latest/coordinates/index.html">its section of the
documentation</a>.</p>
<p>You might also be interested in <a class="reference external" href="http://astroplan.readthedocs.org/">the astroplan affiliated
package</a>, which uses the
<code class="docutils literal"><span class="pre">astropy.coordinates</span></code> to do more advanced versions of the tasks in the
last section of this tutorial.</p>
<hr width="75%" style="margin: 0 auto; margin-top: 16px; margin-bottom: 16px;" />
<p style="text-align: center; width: 100%; font-size:125%;">
    <a href="https://github.com/astropy/astropy-tutorials/tree/master/docs//tutorials/coordinates/coordinates.ipynb">Source notebook</a>
</p>
<hr width="75%" style="margin: 0 auto; margin-top: 16px; margin-bottom: 16px;" /></div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Using <code class="docutils literal"><span class="pre">astropy.coordinates</span></code> to Match Catalogs and Plan Observations</a><ul>
<li><a class="reference internal" href="#Describing-on-sky-locations-with-coordinates">Describing on-sky locations with <code class="docutils literal"><span class="pre">coordinates</span></code></a><ul>
<li><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Using-coordinates-and-table-to-match-and-compare-catalogs">Using <code class="docutils literal"><span class="pre">coordinates</span></code> and <code class="docutils literal"><span class="pre">table</span></code> to match and compare catalogs</a><ul>
<li><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Transforming-between-coordinate-systems-and-planning-observations">Transforming between coordinate systems and planning observations</a><ul>
<li><a class="reference internal" href="#Introducting-frame-transformations">Introducting frame transformations</a></li>
<li><a class="reference internal" href="#Using-frame-transformations-to-get-to-AltAz">Using frame transformations to get to AltAz</a></li>
<li><a class="reference internal" href="#Exercises">Exercises</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Wrap-up">Wrap-up</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../_sources/tutorials/coordinates/coordinates.ipynb.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2013–2017, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3. &nbsp;
    Last built 10 Oct 2017. <br/>
  </p>
</footer>
  </body>
</html>